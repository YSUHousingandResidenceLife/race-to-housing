<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Race to Housing â€” Logo Editor (with Rotation)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css" rel="stylesheet" />
  <style>
    html,body { height:100%; margin:0; }
    #map { position:absolute; inset:0; }
    #controls {
      position:absolute; top:10px; left:10px;
      background:rgba(255,255,255,0.9);
      padding:10px; border-radius:8px;
      box-shadow:0 2px 6px rgba(0,0,0,.25);
      font-family:sans-serif; font-size:13px;
    }
    #controls label { display:block; margin:4px 0; }
    #coords { margin-top:6px; font:12px monospace; white-space:pre-wrap; }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="controls">
    <label>Rotation <input type="range" id="rotate" min="0" max="360" value="0"></label>
    <label>Scale X <input type="range" id="scaleX" min="0.0005" max="0.005" step="0.0001" value="0.003"></label>
    <label>Scale Y <input type="range" id="scaleY" min="0.0005" max="0.005" step="0.0001" value="0.002"></label>
    <button id="saveBtn">Save Overlay</button>
    <div id="coords">Coords will show here</div>
  </div>

  <script src="https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js"></script>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoieXN1LWhybCIsImEiOiJjbWZtcjVkNXUwNTJkMmxvaDZpaTF6b2x2In0.8-4W7BoAy5GmwM2_-L_Jzw';

    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/ysu-hrl/cmfpr50qm00a401ry0uzb5b1q',
      center: [-80.6458, 41.1090],
      zoom: 16.8,
      pitch: 60,
      bearing: -133.6
    });

    // Starting values
    let center = [-80.6458, 41.1090];
    let scaleX = 0.003;
    let scaleY = 0.002;
    let angleDeg = 0;

    map.on('load', () => {
      updateOverlay();

      // update on slider move
      document.getElementById('rotate').oninput = e => { angleDeg = +e.target.value; updateOverlay(); };
      document.getElementById('scaleX').oninput = e => { scaleX = +e.target.value; updateOverlay(); };
      document.getElementById('scaleY').oninput = e => { scaleY = +e.target.value; updateOverlay(); };
      document.getElementById('saveBtn').onclick = () => {
        const coords = computeCoords(center, scaleX, scaleY, angleDeg);
        document.getElementById('coords').textContent =
          "Paste these 4 coords into GitHub:\n" + JSON.stringify(coords,null,2);
      };
    });

    // Compute 4 corners given center + scale + rotation
    function computeCoords([cx,cy], sx, sy, deg){
      const rad = deg * Math.PI/180;
      const cos = Math.cos(rad), sin = Math.sin(rad);

      const pts = [
        [-sx, sy],  // top-left
        [ sx, sy],  // top-right
        [ sx,-sy],  // bottom-right
        [-sx,-sy]   // bottom-left
      ];

      return pts.map(([x,y])=>[
        cx + x*cos - y*sin,
        cy + x*sin + y*cos
      ]);
    }

    function updateOverlay(){
      const coords = computeCoords(center, scaleX, scaleY, angleDeg);

      if(map.getSource('housing-overlay')){
        map.getSource('housing-overlay').setCoordinates(coords);
      } else {
        map.addSource('housing-overlay', {
          type:'image',
          url:'housing-overlay.png',
          coordinates: coords
        });
        map.addLayer({ id:'housing-overlay-layer', type:'raster', source:'housing-overlay' });
      }
    }
  </script>
</body>
</html>
